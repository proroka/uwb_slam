% 22.02.2016
% Amanda Prorok
%
% Run batch EM for mixture of Gaussian and Lognormal
% Input: experimental data
%%

clear 
close all

load ranges_exp1.mat

plot_hist = false

n = size(r,1);
if n < 6
    rows = 2;
else
    rows = 3;
end

if plot_hist
    for i = 1 : n
        subplot(rows,3,i)
        nbins = round(sqrt(length(r(i,:))));
        hist(r(i,:),nbins)
    end
end

% prepare data

offset = [0.4 -0.2 -0.5 -1 -1.7 -1.9 -2.2 -2.4 -4];

i = 9;
data = r(i,:);
d0 = data(~isnan(data)) + offset(i);
d1 = d0((d0~=0));
d = d1(d1>-2);

max_iter = 300;
f_batch_EM(max_iter, d);